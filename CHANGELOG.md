Add test case for W [kEbuFk] line 4.2
Refactor codebase with Z [FPyRwl] line 5.1
Refactor codebase with Z [FPyRwl] line 5.2
