Refactor codebase with Z [AIIWLO] line 3.2
Add test case for W [kEbuFk] line 4.1
